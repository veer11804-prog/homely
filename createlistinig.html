<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Homely - Create Listing</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
  <link rel="stylesheet" href="/assets/styles.css" />
</head>
<body class="bg-vainillaSuede">
  <div class="min-h-screen flex flex-col">
    <header class="site-header">
      <div class="mx-auto w-full max-w-7xl px-4 py-3">
        <div class="flex items-center justify-between gap-3">
          <div class="flex items-center gap-3">
            <a href="/home.html" class="text-2xl font-bold text-[var(--color-primary)] tracking-tight">Homely</a>
          </div>
          <nav class="hidden sm:flex items-center gap-4">
            <a href="/home.html" class="text-gray-700 hover:text-[var(--color-primary)] transition">Home</a>
            <a href="/lisitinig.html" class="text-gray-700 hover:text-[var(--color-primary)] transition">Explore</a>
            <a href="/search.html?type=rent" class="text-gray-700 hover:text-[var(--color-primary)] transition">Rent</a>
            <a href="/search.html?type=buy" class="text-gray-700 hover:text-[var(--color-primary)] transition">Buy</a>
            <a href="/createlistinig.html" class="text-gray-700 hover:text-[var(--color-primary)] transition">Post</a>
            <a href="/contact.html" class="text-gray-700 hover:text-[var(--color-primary)] transition">Contact</a>
          </nav>
          <div class="hidden sm:flex items-center gap-2">
            <a href="/login.html" class="btn-secondary px-3 py-2">Login</a>
            <a href="/signup.html" class="btn-primary px-3 py-2">Sign Up</a>
          </div>
        </div>
      </div>
    </header>

    <main class="flex-1">
      <div class="mx-auto w-full max-w-7xl px-3 sm:px-4 py-4 sm:py-6">
        <h1 class="text-2xl sm:text-3xl font-semibold mb-6 text-[var(--color-primary)]">Create Listing</h1>
        <div class="max-w-3xl mx-auto mb-4">
          <div class="w-full bg-orchidSmoke rounded-full h-2 relative">
            <div id="progress" class="h-2 rounded-full bg-[var(--color-primary)]" style="width:1%"></div>
            <span id="progressPct" class="absolute right-0 top-[-22px] text-xs text-[var(--color-primary)] font-semibold">1%</span>
          </div>
          <div class="text-xs text-gray-500 mb-2">Need help? <a href="#" class="text-[var(--color-primary)] hover:underline">See our guide</a></div>
          <div id="stepTitle" class="mt-2 text-sm text-gray-700">Step 1 of 6: Basic Info</div>
        </div>

        <form id="form" class="space-y-4 max-w-3xl card mx-auto">
          <div id="step1" class="space-y-4">
            <div class="text-xs text-gray-500 mb-2">Enter a catchy title and select the property type.</div>
            <div>
              <label class="block text-sm text-gray-600 mb-1">Title</label>
              <input id="title" class="input text-base" placeholder="Sunny Room" />
            </div>
            <div>
              <label class="block text-sm text-gray-600 mb-1">Type</label>
              <select id="type" class="select text-base">
                <option value="room">Room</option>
                <option value="apartment">Flat</option>
                <option value="house">House</option>
                <option value="pg">PG</option>
              </select>
            </div>
          </div>

          <div id="step2" class="space-y-4 hidden">
            <div class="text-xs text-gray-500 mb-2">Provide location details for better visibility.</div>
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              <div>
                <label class="block text-sm text-gray-600 mb-1">City</label>
                <input id="city" class="input text-base" placeholder="Mumbai" />
              </div>
              <div>
                <label class="block text-sm text-gray-600 mb-1">Address</label>
                <input id="address" class="input text-base" placeholder="Street, area" />
              </div>
            </div>
            <div>
              <label class="block text-sm text-gray-600 mb-1">Nearby places</label>
              <input id="nearby" class="input text-base" placeholder="Parks, schools, transit" />
            </div>
          </div>

          <div id="step3" class="space-y-3 hidden">
            <div class="text-xs text-gray-500 mb-2">Select amenities available in your property.</div>
            <div class="grid grid-cols-2 sm:grid-cols-3 gap-2 text-sm">
              ${['AC','Wifi','Parking','Furnished','Lift'].map(a => `<label class="inline-flex items-center gap-2"><input class="amenity" type="checkbox" value="${a}" /><span>${a}</span></label>`).join('')}
            </div>
          </div>

          <div id="step4" class="space-y-3 hidden">
            <div class="text-xs text-gray-500 mb-2">Upload clear images to attract more renters.</div>
            <div class="border-2 border-dashed rounded-xl p-6 text-center bg-orchidSmoke/40">Drag & drop images here</div>
            <div class="grid grid-cols-3 gap-3">
              ${[1,2,3].map(i => `<div class="aspect-square rounded bg-gray-200 overflow-hidden flex items-center justify-center"><img src="https://source.unsplash.com/120x120/?house,interior,modern,architecture,realestate&sig=${i}" alt="Preview" class="w-full h-full object-cover" /></div>`).join('')}
            </div>
          </div>

          <div id="step5" class="grid grid-cols-1 sm:grid-cols-2 gap-4 hidden">
            <div class="text-xs text-gray-500 mb-2">Set a competitive price and availability status.</div>
            <div>
              <label class="block text-sm text-gray-600 mb-1">Price (INR)</label>
              <input id="price" class="input text-base" placeholder="45000" />
            </div>
            <div>
              <label class="block text-sm text-gray-600 mb-1">Availability</label>
              <select id="availability" class="select text-base">
                <option>Available</option>
                <option>Not available</option>
              </select>
            </div>
          </div>

          <div id="step6" class="space-y-2 text-gray-700 hidden">
            <div class="font-medium">Preview</div>
            <div class="text-xs text-gray-500 mb-2">Review your listing before publishing.</div>
            <div id="preview"></div>
          </div>

          <div class="flex flex-col sm:flex-row gap-2">
            <button type="button" id="prev" class="btn-secondary flex-1">Previous</button>
            <button type="button" id="next" class="btn-secondary flex-1">Next</button>
            <button type="submit" id="publish" class="btn-primary flex-1 hidden">Publish</button>
          </div>
        </form>
      </div>
    </main>

    <footer class="bg-white border-t shadow-sm mt-auto">
      <div class="mx-auto w-full max-w-7xl px-4 py-8 text-center text-gray-500 text-xs">
        © <span id="year"></span> <span class="text-[var(--color-primary)] font-semibold">Homely</span>. All rights reserved.
      </div>
    </footer>
  </div>

  <script type="module">
    import { initHeader, setActiveNav, getListings, saveListings, formatINR } from '/assets/app.js';
    initHeader();
    setActiveNav(location.pathname);
    document.getElementById('year').textContent = new Date().getFullYear();

    const steps = ['Basic Info','Location','Amenities','Images','Pricing','Preview'];
    const minPercent = 1;
    let step = 1;
    const form = document.getElementById('form');

    function updateStep() {
      for (let i=1;i<=6;i++) document.getElementById('step'+i).classList.toggle('hidden', i!==step);
      document.getElementById('prev').disabled = step===1;
      document.getElementById('next').classList.toggle('hidden', step===6);
      document.getElementById('publish').classList.toggle('hidden', step!==6);
      const pct = step===1 ? minPercent : minPercent + ((step-1)/(steps.length-1))*(100-minPercent);
      document.getElementById('progress').style.width = pct+'%';
      document.getElementById('progressPct').textContent = Math.round(pct)+'%';
      document.getElementById('stepTitle').textContent = `Step ${step} of ${steps.length}: ${steps[step-1]}`;
      if (step===6) {
        document.getElementById('preview').innerHTML = `
          <div>Title: ${document.getElementById('title').value || '—'}</div>
          <div>City: ${document.getElementById('city').value || '—'}</div>
          <div>Price: ${document.getElementById('price').value ? 'INR '+formatINR(document.getElementById('price').value) : '—'}</div>
        `;
      }
    }

    document.getElementById('prev').addEventListener('click', () => { step = Math.max(1, step-1); updateStep(); });
    document.getElementById('next').addEventListener('click', () => { step = Math.min(6, step+1); updateStep(); });

    form.addEventListener('submit', (e) => {
      e.preventDefault();
      const newListing = {
        id: Date.now().toString(),
        ownerId: 'u1',
        title: document.getElementById('title').value,
        description: '',
        type: document.getElementById('type').value,
        price: Number(document.getElementById('price').value || 0),
        currency: 'INR',
        address: document.getElementById('address').value,
        city: document.getElementById('city').value,
        bedrooms: 1,
        bathrooms: 1,
        amenities: Array.from(document.querySelectorAll('.amenity:checked')).map(i => i.value),
        status: 'published',
        createdAt: new Date().toISOString(),
        updatedAt: new Date().toISOString(),
        images: [],
      };
      const listings = getListings();
      listings.push(newListing);
      saveListings(listings);
      alert(`Saved: ${newListing.title} - INR ${newListing.price} in ${newListing.city}`);
      window.location.href = '/lisitinig.html';
    });

    updateStep();
  </script>
</body>
</html>
